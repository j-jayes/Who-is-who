---
title: "Praise the people or praise the place?"
subtitle: Upper tail human capital in electrifying Sweden
code-repo: "Access the code, data, and analysis at <https://github.com/j-jayes/who-is-who-scraper> and <https://github.com/j-jayes/svensk-industrikalender>"
author:
  - name: Jonathan Jayes
    email: jonathan.jayes@ekh.lu.se
    orcid: 0000-0003-4967-4869
    affiliations: 
      - id: lu
        name: Lund University Economic History Department
abstract: |
  This paper explores the transformative role of Artificial Intelligence in economic history research, through the examination of the skilled workforce in Sweden's electricity sector during the mid-20th century. By ingesting and analyzing two unique data sources—a set of biographical dictionaries and an industrial catalogue—the study investigates the origins and trajectories of high-skilled workers in electricity-related occupations in Sweden. Contrary to previous assumptions that local talent predominantly drove the technological advancements, the findings reveal a bifurcated labor market. Highly educated and skilled professionals, crucial in overseeing and advancing the electricity sector, frequently migrated for education and career opportunities, often traveling significant distances from their birthplaces. In contrast, local talent primarily occupied the burgeoning middle-skilled roles within the sector.
date: 12 January, 2024
thanks: |
  Thank you to seminar participants at the Copenhagen Business School Department of Strategy and Innovation PhD Seminar  and the HEDG Group at the University of Southern Denmark for valuable feedback on this work.
format:
  hikmah-pdf: default
  hikmah-manuscript-pdf: default
# format:
#   docx:
#     toc: true
#     number-sections: true
#     highlight-style: github
execute: 
  echo: false
  warning: false
  message: false
bibliography: bibliography.bib
---

## Introduction

Economic history as a discipline is set to benefit in at least three ways from the nascent AI revolution. Novel sources of data become available as new tools make them readable to machines, analysis in new ways is possible with new kinds of algorithms, and the time-cost of asking certain kinds of questions decreases, opening up new avenues for research. In this paper, I make an attempt to leverage these benefits to answer the question, 'who were the high skilled workers in electricity related occupations in Sweden, and where did they come from?' I detail the process of structuring and analyzing two novel data sources, a set of biographical dictionaries and an industrial catalogue, in order to answer this question.

In the quest to understand the dynamics of economic development and technological advancement, previous research by this author and his supervisors shed light on the transformative impact of early electricity access in Sweden. "Power for progress: The impact of electricity on individual labor market outcomes" [@jayes_power_2024] revealed how the advent of electricity in certain parishes led to positive economic outcomes: a boost in income levels, reduced inequality, and the maintenance of employment levels despite the advent of labor-saving technology. A particularly striking observation was the tendency of workers in these early electrified parishes to remain in their birthplaces, hinting at a newfound economic vibrancy stemming from the income spillovers into sectors not affected by the new technology.

Building on these insights, the present paper delves deeper into the human aspect of this technological revolution. It poses a critical question: Who were the key figures driving this change? Were they local talents nurtured by the opportunities at hand, or did they represent a wave of skilled individuals drawn from afar, lured by the pioneering spirit of these early electrified areas?

To answer this, the investigation leverages two novel and rich data sources. The first, *Vem är Vem*, is a comprehensive set of biographical dictionaries containing the profiles of 75,000 notable Swedes active between 1945 and 1968. The second, the "Svensk Industrikalender" or Swedish Industrial Calendar of 1947, offers an exhaustive catalogue of industrial firms, detailing their activities, workforce, and financial metrics.

I digitize and structure these sources in order to analyze the changing patterns of the Swedish labour market in the middle of the 20th century in light of electrification. The findings challenge my prior expectations. Contrary to the belief that local talent pools predominantly fueled the technological boom, I observe a pattern of geographical mobility among the highly educated and skilled professionals in electricity-related fields. These individuals, pivotal to overseeing and advancing the electricity sector, often sought education and opportunities far from their origins. This suggests a bifurcated labor market: local talent predominantly filled the burgeoning middle-skilled roles within the electricity sector, while the top-tier skilled professionals were more transient, moving towards educational and occupational opportunities. This paper explores the implications of this labor market structure for the economic development patterns witnessed during Sweden's second Industrial Revolution.

These findings, tentative as they are, have real world value. As we seek to understand what drove the dynamism during the age of electrification in Sweden, we are better equipped to shape policy today that seeks to revitalize deindustrializing areas across the developed world and help the developing world harness new technologies for sustainable growth. In addition, the methodologies employed to structure and analyze archival data can provide a template for future research using similar materials.

The paper is laid out as follows: the current research question is placed in context, the sources are explained, followed by their digitization and structuring process. I then discuss the classification task involved in assigning engineers to a sector based on their occupational trajectories. I then lay out some descriptive statistics and tentative findings regarding the patterns of movement for the high skilled electricity related workers, compared with other professionals I observe in the biographical dictionaries.

## Related Literature

This paper ties into three strands of literature; two in content and one in methodology. The first strand focusses on the use of individual level biographic data in economic history, at scale. The second strand focusses on the importance of human capital in economic development. The third strand focusses on the use of new tools to structure and analyze historical data.

### The use of individual level biographic data in economic history at scale

Several recent papers have made use of biographic data in innovative ways. @ford2023not use biographies of high school graduates compiled at the time of their school reunions to create a far richer measure of human capital than the conventional measure, number of years of schooling, alone. Titled, "Not the Best Fillers in of Forms? The Danish and Norwegian Graduate Biographies and 'Upper Tail Knowledge'", the authors explain that these biographies are "mini-CVs", containing information about the school leaver's grades, their occupational trajectory, and their family background. These are used to create an innovative approach to measuring upper tail knowledge.

@Nekoei2020Herstory titled "Herstory: the rise of self-made women" analyzes the historical prominence of self-made women using a specially created database. This database, formed by applying machine learning to Wikidata and Wikipedia, catalogues notable individuals throughout history, highlighting details like occupation and family background. Their unique approach reveals a significant increase in the number of prominent women, especially those who achieved success independently of their family connections, across various fields, starting with literature, since the 17th century. This research provides a fresh perspective on women's historical achievements and roles.

Importantly, these papers go beyond the use of just administrative records, which contain register-like data that economic historians are familiar with. Leveraging new kinds of sources in this way allows the authors to approach their research with different kinds of questions.

In this paper, I structure biographic data about elite individuals that is similar in structure to @ford2023not, and use the career trajectories of these individuals to better understand the contribution of educated workers to the adoption of electricity across Sweden in the 20th century. The differentiator in this case is the scale - I capture 75,000 individuals in Sweden in an automated manner, or about one percent of the population of the country at the time.

### The importance of human capital in economic development

The question of where the high skilled workers in electricity related occupations in Sweden came from is important in order to understand the economic dynamism of that era. As such, it ties into a wealth of research on technological change and the labour market, which I review briefly here.

The historical adaptability of labor markets to technological change is well-documented. In their study of the U.S. labor market's response to the automation of telephone operation, @Feigenbaum2020 demonstrate how technological displacement in one sector led to increased demand in others, suggesting an inherent resilience in labor markets. This finding is particularly pertinent to this exploration of Sweden's electrification, as it indicates a potential for both displacement and opportunity in the face of technological change.

Claudia Goldin's extensive analysis of labor markets in the 20th century provides a comprehensive backdrop to this study [-@Goldin1994; -@Goldin1998]. Her work highlights critical shifts in labor participation, wage structures, and job security, reflecting the complex interplay between societal changes and labor market dynamics. These insights are crucial for understanding how shifts in human capital, like those during Sweden's electrification period, contribute to broader economic outcomes.

The impact of the Digital Revolution on labor markets, as reviewed in the Oxford Review of Economic Policy, is also salient to our study [@Adams2018; @Goos2018]. These articles underscore the emergence of job polarization and the crucial role of policy interventions in ensuring equitable benefits from technological advancements. This perspective is instrumental in understanding the differential impacts of electrification in Sweden, especially in terms of job creation and labor market segmentation.

Moretti’s exploration of the geographical clustering of talent and innovation in "The New Geography of Jobs" provides a crucial perspective on the spatial dynamics of economic development [@Moretti2012]. His findings about the importance of local ecosystems in fostering innovation and economic vitality resonate with our investigation of how early electrification in Swedish parishes influenced the distribution and impact of skilled labor. His concern, that gains to productivity are eaten up by increased cost of living (primarily through housing costs) when constraints prevail, is not evidenced in the first half of the 20th century in Sweden. However, his example of Silicon Valley -- where high productivity and attractive jobs draw in people with high levels of skill, raising property prices - is becoming more concerning in today's relatively housing scarce urban centers.

New technologies require new skills. Mokyr's research provides insights into the importance of both artisans and engineers in the progression of the Industrial Revolution. His studies underscore the synergistic relationship between theoretical knowledge and practical expertise, essential in driving technological innovation and economic progress [@Mokyr2017]. In his examination of the socio-economic elites of early modern Europe, Mokyr explains how their education and exposure to new ideas and sciences were pivotal in fostering various intellectual and technological advancements. This educated elite, through their changing culture and institutions, played a crucial role in creating an environment conducive to innovation [@Mokyr2017Journal].

Not every innovator needs higher education. Mokyr's perspective is crucial in understanding the dynamics of technological development and economic growth, emphasizing the collaborative efforts between well-educated scientists and highly skilled artisans. This interplay highlights the importance of practical skills, theoretical knowledge, and their combined impact on technological progress. For example, figures like metallurgist Henry Cort, who collaborated with scientists despite lacking formal scientific training, exemplify the productive synergy between different forms of expertise in this era [@Mokyr2017Journal].

In this paper, I want to find out where the individuals came from who enabled the technological development that was associated with Sweden becoming richer and more equal. Did they come from the areas around where the technology was developed / adopted, learning skills on the job? Or did they get formal education at one of Sweden's universities and then bring these skills to the hubs of technology? Should we praise the people, or the place?

### The use of new tools to structure and analyze historical data

The third strand of literature that this paper ties into is the use of new tools to structure and analyze historical data. Within this strand, there are perhaps two main use cases; problems of prediction and classification, and 'big data' gathering and analysis.

Relating to the former, @mullainathan2017machine wrote a pathbreaking article that documents the use of machine learning as part of an economists toolkit in the context of prediction problems, differentiating it from traditional parameter estimation. The authors explain the use of new data types like satellite images and text, as well as machine learning's role in policy, estimation, and testing economic theories. 

Some interesting papers that incorporate prediction and classification problems include @Bandiera2020ceo, who classify CEO behavior by collecting high-frequency diary information and then use a machine learning algorithm to classify CEOs into 'leaders' and 'managers' by the content of their meetings. @koschnick2023breaking uses a machine learning topic model to classify each paper by the universe of all students at English universities in the seventeenth and early eighteenth century to calculate a measure of how innovative the paper was; how it differed from the papers before it in the field and how similar the papers afterwards were. @DahlVedel2024 in a paper titled "Breaking the HISCO Barrier: AI and Occupational Data Standardization" apply a neural network to the task of classifying an occupational description and benchmark their results against human labelling to show that the neural network achieved comparable accuracy with human labelling and involved an order of magnitude fewer human hours.

'Big data' papers in economic history now abound, as surveyed in @gutmann2018big in a review titled *'Big Data' in Economic History*. Many of these papers construct and use high quality register or census-like data on individual outcomes. Notable examples include the Longitudinal, Intergenerational Family Electronic Micro-Database Project by Martha Bailey which focuses on family histories to understand long-term economic trends. These histories are collected from various census-like sources and innovative ML tools are used to construct the longitudinal links. Similarly, "The Making of Modern America: Migratory Flows in the Age of Mass Migration" by @bandiera2013making involved the digitization of 24 million records of migrant flows through Ellis Island in New York, and found that measured out-migration rates in the US were double the reported figures in the earliest decades of the 20th century. @eichengreen2021gold uses natural language processing (NLP) to understand the content of a parliamentary committee debate on the gold standard in South Africa. Clark and Cummins' families of England database contains 1.7m marriage records in England from the 19th to the 21st centuries and allows to authors to pry out social dynamics in family formation, as well as geographic sorting between the North and South of England [-@Clark2018BigSort].

There is also a growing literature in which authors lay out the step by step processes required for economic historians to make use of these new tools. A great paper in this vein that bridges the gap between cutting-edge computer science literature and the use cases of applied economists is by @correia2023digitizing. The paper "Digitizing Historical Balance Sheet Data: A Practitioner’s Guide" explores the application of machine learning, particularly Optical Character Recognition (OCR), to digitize large-scale historical economic data. The authors highlight the limitations of off-the-shelf OCR software, mainly due to high error rates, and propose a combination of pre- and post-processing methods to enhance accuracy. They apply these methods to two extensive datasets of balance sheets and introduce "quipucamayoc," a Python package that unifies these techniques.

@amujala2023digitization, in "Digitization and data frames for card index records" explain the entire process through which they digitize and structure loan records from bank cards that contain both machine written and hand written text in varying formats over time. Tha authors lower the barrier to entry for other researchers by explaining their use off-the-shelf technology from Amazon Web Services. Each step is explained along with tips for successful extraction of handwritten information. 

Perhaps the most impressive of these kinds of papers is the *Layout Parser* from Melissa Dell and her lab. The team have produced a python library that can be fine tuned to parse document type, extract information, and use machine learning to correct common errors at the point of data extraction. Dell demonstrates the use of this tool by extracting firm performance data from Japanese reports on yearly firm output which are atypical from the kinds of tables or column text that off-the-shelf optical character recognition tools have been trained on [-@dell2020large].

I hope that this paper can be useful for other researchers using similar kinds of sources as a prompt on where to start collecting and structuring their data at scale.

## Source material

### Biographical dictionaries

*Vem är Vem?* is a biographical dictionary, comprising a rich repository of information about notable individuals in Sweden. Published in two regional editions with a total of five volumes each, the first edition spanned from 1945 to 1950, and the second from 1962 to 1968, by the Bokförlaget Vem är Vem publishing house [@harnesk1945vem]. An additional volume specifically focussed on individuals in industry and business was produced in 1945. This encyclopedia offers an invaluable snapshot of Swedish societal and professional landscapes during these pivotal periods.

The primary intention behind the creation of *Vem är Vem?* was to spotlight individuals who were at the peak of their careers, regardless of their age. This focus extends beyond traditional measures of influence, emphasizing the importance of those in influential positions or notable roles across relatively diverse sectors. As such, it serves as a crucial resource for understanding the professional and personal trajectories of around 75,000 individuals who shaped Swedish society in the mid-20th century. 

It is worth noting that the criteria for inclusion was somewhat vague, and individuals could opt in to being included for a nominal fee. As a result, there are some individuals for whom not much information is included beyond biographic information, current location and profession. For others, there is a rich tapestry about their lives including records of career progression, business travel, technical writings and membership of civic organizations. The source does not capture a representative picture of Swedish society at the time, but rather those individuals with some level of social cachet or prestige, and a desire to be recorded in the biographical dictionaries as such.

*Vem är Vem?* is useful to economic historians thanks to its high quality digitization, with nine out of the 11 total volumes being made accessible online by librarians in Uppsala through *Projekt Runeberg*, as shown in @fig-who-is-who-books. This digitization has facilitated research, allowing for a broader exploration of the biographies and career paths of thousands of individuals. The encyclopedia's extensive coverage makes it a goldmine for researchers, historians, and anyone interested in the socio-economic history of Sweden during a period marked by significant change and development.


```{r}
#| label: fig-who-is-who-books
#| fig-cap: "Number of biographies in each volume of 'Vem är Vem?'"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/who-is-who-volumes.png")
```

In the context of economic and historical research, 
*Vem är Vem?* serves as a unique tool. By providing detailed biographies and career information, it allows for an in-depth analysis of the human capital that contributed to Sweden's economic and social evolution during the mid-20th century.

The biographic information about the individuals in the dictionaries are exemplified in @fig-who-is-who-page, which highlights the life of chemist and metallurgist Karl Gustaf Lund.

```{r}
#| label: fig-who-is-who-page
#| fig-cap: "A representative page of Vem är Vem?, highlighting the biography of Karl Gustaf Lund"

knitr::include_graphics("assets/vem_page.png")
```

The fields include:

1.   **Education**: Lund’s education at prestigious institutions such as the Royal Institute of Technology (KTH) indicates he had access to advanced technical knowledge. This level of education is critical for understanding the specialized skills that were necessary for innovation and advancement in electricity-related industries.
    
2.   **Career Progression**: The text outlines Lund’s career progression through various roles in metallurgy and chemical engineering. This trajectory can illustrate how individuals applied their education in practice, contributing to industrial development. Tracking such careers can provide insight into the professional development paths that were common and valued in the sector at the time.
    
3.   **International Experience**: His experiences in the United States reflect the cross-border exchange of knowledge and skills. This can show how international experiences contributed to the domestic industry by importing new ideas and practices, which is a key aspect of human capital development.
    
4.   **Leadership and Management**: Lund’s leadership positions, such as chairmanships and advisory roles, imply a combination of technical expertise and managerial acumen. The ability to lead and innovate within companies is a significant aspect of human capital that drives industry growth.
    
5.  **Research and Innovation**: The reference to his translated research work indicates an engagement with cutting-edge technology and knowledge creation. Such contributions are the tangible outputs of human capital in action, pushing the industry forward through innovation.
    
6.   **Professional Networks**: His involvement with societies and associations suggests a networked professional community, which is essential for the diffusion of innovative ideas and practices. These networks are often where knowledge is exchanged, partnerships are formed, and collaborations are initiated.

I use this biographical data to determine who the high skilled workers in electricity related jobs in Sweden were, and understand more about their career trajectories.

### Industrial Catalogue

The *Svensk Industrikalender*, published by Sveriges Industriförbund (Sweden's Industrial Association), is a comprehensive directory of Swedish industrial firms. This calendar was issued annually from 1918 to 2000 and contains information related to Swedish industry. The 1947 edition available on the *Project Runeberg* website was digitized in April 2012, sourced from the Centrum för Näringslivshistoria. The calendar is believed to be under catalog protection but not copyright .

It includes detailed information such as company names, locations, nature of businesses, products, contact details, share capital, number of employees, production values, establishment years, and key personnel including managing directors and board members. This source is valuable for studying the economic and industrial environment of post-war Sweden, providing insights into corporate structures, industry distribution, and business trends of that period. 

A representative page is shown in @fig-industry-calender.

<br>

```{r}
#| label: fig-industry-calender
#| fig-cap: "A page of the industry catalogue from 1947"
#| fig-width: 6
#| out-width: 6in


knitr::include_graphics("assets/svensk-industrikalender_1.png")
```

The common fields listed for each company entry in the catalogue are as follows:

1. **Company Name**: The name of the company is listed at the beginning of each entry, with an asterisk indicating membership of Sveriges Industriförbundet.

2. **Location/Town**: The town or location of the company, which in this case is *Arboga*.

3. **Description of Business**: A brief description of the company's main activities or products is provided.

4. **Products or Services Offered**: Specific items or services the company provides, such as types of machinery, tools, or materials.

5. **Contact Information**: This typically includes:
   - **Telegraph Address**: Listed as "Telegr.-adr." indicating the address to which telegraphs are to be sent.
   - **Telephone Number**: Listed as "Telefon" followed by the number.
   - **Postal Code**: Mentioned as "Postgiro" or "Postiro" with corresponding numbers.
   - **Bank Account**: Sometimes a bank account number or similar financial information is included.

6. **Management and Key Personnel**: Names and titles of important figures in the company, such as the director (*Verkst. dir.*, board members, or founders.

7. **Financial Information**: Information about the financial aspect of the company, such as capital invested (*Akt.-kap.*) or turnover (*Tillv.-värde*).

8. **Establishment Details**: This includes the year of establishment and sometimes the history or lineage of the company's ownership or major changes.

9. **Address**: The full postal address, which may include a street name or a postbox number, indicated as *Postgiro*.

This type of catalogue was commonly used for business-to-business interactions and can be considered an early form of networking resource, allowing companies to find suppliers, customers, and partners.

I use the industry calendar to uncover geographic clusters of firms that produced goods related to electricity for sale to consumers or to other businesses. I use these geographic clusters to understand the migration patterns among engineers in Sweden.

## Data collection strategy

In order to analyze both the biographical dictionaries and industrial catalogue, we need to bend the text into a machine readable structure. This process is not complicated, but somewhat involved. It includes breaking each component of the source up (e.g. each biography or company record), extracting the pertinent information from each record, storing each value with its associated key, and then saving this information in a way that is easy to analyze and aggregate. 

The simplified process is laid out in @fig-data-collection-process. The underlying code can be found on the GitHub repo linked at on the first page of this paper. I detail the third step, structuring the records, in the section below, and the remainder of the steps in the appendix. 

```{r}
#| label: fig-data-collection-process
#| fig-cap: "Data collection process steps"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/data-collection-process.png")

```

Prior to the advent of Large Language Models (LLMs), this structuring of data from free text into key-value pairs was a task that required a large number of human hours to complete. It could be done either by putting the information into an excel sheet by hand, or writing rules to extract the information from the text. The first approach limits the number of observations a researcher can collect on her own, and the second approach quickly turns into the first. 

The biographical dictionaries are written in a specific way, with many abbreviations and contracted names for common field titles and values. Due to the number of abbreviations, acronyms and contractions (for example, `Gävleb. l.` is the contraction of *Gävleborg län* or Gävleborg county in @fig-who-is-who-page), while it might be possible to take a simple rules based approach to replacing these contractions with their complete Swedish text, and then looking with regular expressions for specific terms relating to each piece of information, the number of rules soon balloons to an unreasonable figure, making the process unwieldy at best and impossible at worst. Writing a rule for every case necessitates as much human involvement as would be required to manually structure the information - the first approach. 

However, with the rapid advancements in LLM technology in the previous five years, and popular adoption of these tools through Chat-GPT and Microsoft's integration of GPTs into their products in the previous year, new tools mean this manual workload can be avoided to a large extent. 

The structuring step involves sending a specific prompt to a LLM, along with the source material as text (rather than a scan of the book), and receiving back from the LLM a structured file with a key and value for each piece of information that I am interested in.

I make use of the computational backend of Chat-GPT, a model called GPT-3.5-turbo from OpenAI to structure the information from the dictionaries and catalogue into a JSON format that I can analyze, step 3, as shown in @fig-data-collection-process. Many other LLMs, some open source, are available. I have chosen GPT-3.5-turbo as it is simple to interact with it in the programming language Python, and because doing so is relatively affordable for contained workloads such as this, when compared to hosting such a model on your own, beefy, costly computer.

By passing the text to the LLM, along with some context about what the model is being given, the model can behave like a skilled research assistant, reading the records, searching for the specific pieces of information requested, and outputting a structured file containing the information that we seek.

### Intuitive explanation of LLMs contextual 'understanding'

The GPT-3.5-turbo model which I make use of is a LLM which has been trained on all of Wikipedia and Wikidata, among other training material. These two sources contain the same information, but in a different format, as shown in the adapted extracts below; the text and @fig-wiki mimic the kind of material that the model I use is trained on. 

As the base model underlying GPT-3.5-turbo is pre-trained to predict the next token on this kind of data, it has developed the ability through repeated exposure to this kind of biographic data to produce structured information from free text, and likewise construct natural sounding text from pieces of structured information. With the addition of *JSON mode* to the model, it is able to output structured information in a reliable manner as detailed in @openai2024text.

<blockquote>

*Jonas Wenström (4 August 1855 in Hällefors – 22 December 1893 in Västerås) was a Swedish engineer and inventor, who in 1890 received a Swedish patent on the same three-phase system independently developed by Mikhail Dolivo-Dobrovolsky. He studied at Uppsala University.*

</blockquote>

```{r}
#| label: fig-wiki
#| fig-cap: "Wikidata information about Swedish inventor Jonas Wenström, inventor of three-phase current"

library(tibble)

wenstrom_data <- tibble(
  key = c("Name", "Birth Date", "Death Date", "Occupations", "Education"),
  value = c("Jonas Wenström", "1855-10-04", "1893-12-21", "Engineer, Inventor", "Uppsala University")
)

library(gt)

wenstrom_data %>% 
gt() %>% 
cols_label(key = "Key", value = "Value")


```

<br>

### Prompting and context

Due to the large amount of material that GPT-3.5-turbo has been exposed to in training, it is familiar with the kinds of biographical text that I want it to structure. In order to draw on its familiarity with this kind of material, I need to provide it context about the biographical text it is being passed, and ensure that the model returns output in a useful way. I explain these prompts below.

A "system prompt" can be used to tell the model what kind of material it will be passed, and how it should respond. OpenAI suggest that users "ask the model to adopt a persona" in order to improve responses in a specific task in a guide on prompt engineering [@OpenAI2023PromptEngineering].

I use a simple prompt to tell the model that it will be exposed to Swedish language biographical data:

<br>

`system_prompt = "You are an expert on Swedish biographies."`

<br>

Next I explain the kinds of information that I want it to extract, and the exact format that I want it in. I do this by specifying a JSON schema, with fields that it must return and specifications for the kind of data in each field. An except of the schema is shown in @fig-schema. 

```{r}
#| label: fig-schema
#| fig-cap: "Excerpt of structuring schema"
#| fig-width: 3
#| out-width: 3in

knitr::include_graphics("assets/schema-2.png")
```

Finally I provide detailed context about the source and instructions for what I want the system to do. I include examples of the abbreviations and contractions that it will encounter, and inform the model as to what kind of output I am expecting in return.

<br>


`structure_prompt = "Task: read the schema and return RFC compliant JSON information about the Swedish individuals from the 1950 biographical dictionary 'Vem är Vem' that is provided below. Use a numeric index for each biography in your JSON output and return information about all of them, including all career information available. Keep the biographic descriptions in Swedish and remove any abbreviations based on your knowledge, e.g. 'fil. kand.' is 'filosofie kandidat', and 'Skarab. l.' is 'Skaraborgs Län'. Put years in full based on context. Put dates in dd/mm/yyyy format where possible. If there is no information for a key, leave it out. If there is no information for a required key, put NULL as the value.`

<br>


### Example of structured biographic text

Following this process of structuring the records into a format with specified keys and values, I augment the data by geocoding locations in order to analyze geographic paths of individuals in the sample, and geographic clusters of firms.

Below I show the output of the data collection process, where the biographical dictionary entry on Swedish engineer and power station manager Axel Verner Nordell is shown in @fig-axel and some of the extracted information along with the geocoded coordinates are shown in @fig-axel-tab.

```{r}
#| label: fig-axel
#| fig-cap: "Raw information about Swedish engineer and power station manager Axel Verner Nordell"
#| fig-width: 3
#| out-width: 3in

knitr::include_graphics("assets/axel.png")

```

{{< pagebreak >}}

```{r}
#| label: fig-axel-tab
#| fig-cap: "Extracted information about Axel Verner Nordell"


person_info <- tribble(
  ~key, ~value,
  "full_name", "Nordell, Axel Verner",
  "location", "Motala, Östergötland",
  "occupation", "Civilingenjör, kraftverksdirektör",
  "birth_date", "15/08/1881",
  "birth_place", "S. Möckleby, Kalmar",
  "birth_parents", "Gustaf N. and Amanda Seillergren",
  "birth_latitude", "56.35646300000001",
  "birth_longitude", "16.420155",
  "education_degree", "Studentexamen",
  "education_year", "1899",
  "education_institution", "Lunds högre allmänna läroverk",
  "education_latitude", "55.7046601",
  "education_longitude", "13.1910073"
)

person_info %>% 
gt() %>% 
cols_label(key = "Key", value = "Value") 

```

<br>

## Clustering of firms and classification of occupations

The next task required to understand where these individuals came from and what kinds of firms they were drawn to involved grouping the firms from the catalogue and then classifying each individual in the biographical dictionaries into a particular occupation.

For both of these tasks, I leaned on the tools of text embeddings, and a combination of unsupervised machine learning and advanced language processing techniques. I made use of a text embedding model trained on Swedish language text by the @bert-base-swedish-cased. It is an adaptation of the breakthrough BERT model, introduced by Google Research in 2018 [@google2016bert]. The advantage of this KB Lab model is that it has been trained on a selection of Swedish data, including books, news reports, and internet forums. Hence it is able to score the similarity of Swedish business descriptions and occupational titles.

Text embeddings are effective for clustering because they capture semantic meaning rather than relying on surface-level features like character composition. For example, while "steam engine" and "power station" are different in characters and literal meaning, they are semantically related in the context of industrial machinery and energy production. Text embeddings transform these phrases into numerical vectors that reflect this semantic similarity. When applied to clustering, this means that items with similar meanings, even if their literal expressions differ, are grouped together based on the contextual and conceptual similarities encoded in their embeddings. This capability makes text embeddings particularly powerful for organizing and categorizing text data in a way that aligns with human understanding and interpretation [@jurafsky2023speech].

### Classifying occupations

In @jayes_power_2024, we grouped occuaptions into three categories; direct electricity jobs (e.g. electricians), indirect electricity jobs that could benefit from electric motors (e.g. textile workers), and all other jobs. We made this classification based on the occupational title listed in the 1930 census alone. These titles are frequently used in economic history, along with a schema that classifies each title according to a list of possible titles and occupational descriptions. A widely used example is the Historical International Standard Classification of Occupations, or HISCO, defined originally by @vanLeeuwen2002HISCO. A wealth of mappings have been created that link an occupational string like *civilingenjör* to HISCO code 022, civil engineers, described as:

<br>

*Workers in this unit group carry out research and advise on civil engineering problems, design projects and structures such as bridges, dams, docks, roads, airports, railways, waste disposal systems, flood control systems and industrial and other large buildings, and plan, organise and supervise their construction, maintenance and repair.*

<br>

While this classification process used to involve a large amount of human hours, several new methods that use machine learning have emerged to make this process more efficient. @DahlVedel2024 use a neural network to classify occupational strings using a supervised machine learning process based on the occupational titles in several waves of Danish census data. @merouani2023innovation uses an unsupervised approach based on text embeddings to classify french occupational titles according to the HISCO schema, using a clever compartmentalization strategy to improve classification when individuals hold multiple titles. 

In this paper I take a slightly different approach, making use of the additional data from the occupational trajectories of each individual; where they worked and what position they held at each firm or institution. This additional data helps me go beyond just a single occupational string and classify the sector that each engineer worked in. In many instances, the description of the individual in the biographical data relates to their education, rather than what they have done with it.

For example, while it is clear from Axel Nordell's occupational title, *Civilingenjör, kraftverksdirektör* (civil engineer, power station director), that he worked in a directly electricity related occupation, this is not clear for Gustaf Fredrik Ambjörn, whose title is just *Civilingenjör*, based on the fact that he recieved the degree of *Civilingenjör* from the Royal Institute of Technology (KTH) in Stockholm. When looking at his career trajectory, however, we can see that he began his career working at "Fore River Shipbuilding Co., Quincy, Mass., USA" and ended it working as a "Professor i praktiskt skeppsbyggeri" (professor in practical shipbuilding) at Chalmers Institute of Technology in Gothenburg.

I develop a two step process to classify first an individual's occupation based on their occupational title and then a sector based on their occupational trajectory. In both cases I use an unsupervised machine learning approach that turns the titles and work history from text into vector representations of text, and then cluster these vectors in order to assign a HISCO code and then a sector.

To get an intutive understanding of the clustering process, it is worth showing the relative similarity of a sample of occupations from the HISCO schema. @fig-hisco-cluster shows a scatterplot with some of the different occupations listed in HISCO. 

We can see a cluster in the top right hand corner of the plot showing basketry weavers and brush makers adjacent to sewers and embroiders, and weaving-and knitting machine setters and pattern card preparers. These occupations belong to HISCO major group of production and related workers, and so are all green in the figure. In the bottom left corner we see bacteriolgists, medical doctors and veterinary assistants. On the far right of the plot, we see university lecturers and special education teachers. The takeaway is not necessarily where the occupations fall in the plot, but rather that similar occupations are close to one another in the vector space, and further from dissimilar occupations. 

To create this plot, I used the @bert-base-swedish-cased library to create text embedding vectors for each occupation and description in the HISCO schema. Each vector has 364 dimensions, representing the semantic content of the occupation title and description. To produce the figure, I have used dimensionality reducation to collapse the vector representation down from 364 dimensions to just two so that I could plot them on the x and y axis, which I have done with the Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) library.

```{r}
#| label: fig-hisco-cluster
#| fig-cap: "Scatter plot showing the relative similarity of occupational titles in the HISCO schema"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/hisco_cluster.png")
```

In order to classify the occupations from the *Vem är Vem* source according to the HISCO schema, I use this same projection of HISCO occupations, as well as projecting each occupational title into the vector space (in Swedish). I then do a simple cosine distance calculation to find the closest HISCO code to each occupational title in the vector space, and call that the 'most similar HISCO' to the occupational string. I experimented with a threshold for the cosine distance, and found that setting it such that roughly 85 percent of the sample recieved HISCO codes produced results that appeared reasonable. While somewhat arbitrary, this approach allowed for a contextually relevant classification of occupations, drawing on the advanced language understanding capabilities of the KB BERT model. More work to benchmark and score this process is needed in the future.

In the next step, I extract the career trajectories for each engineer. I choose engineers because the other HISCO occupations that make up my sample do not have sufficient information to differentiate their work into sectors. The other largest HISCO occupations in the *Vem är Vem* source are shown in @fig-hisco-counts, being doctors, university teachers, dentists and ministers.

```{r}
#| label: fig-hisco-counts
#| fig-cap: "Most common HISCO occupations in Vem är Vem"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/hisco_counts.png")
```

I group the terms from the career trajectories for each individual, project them into the vector space using the same NLP library as before and compare them to the firm clusters by business type that I explain below.

### Clustering firms by business type and geography

For grouping firms by business type, I again used the k-means clustering algorithm, to categorize firms into 20 distinct categories. This algorithm works by partitioning the data into k distinct clusters based on features (in this case, text embeddings derived from company descriptions) [@jurafsky2023speech]. I experimented and decided on 20 clusters and manually labelled each cluster based on the firm names and business operations of the firms in the different clusters.

The result of this classification is visible in @fig-density-ridges, which shows the number of firms founded each year by category from the industrial catalogue. The clusters are ordered by peak year for foundation. We see that breweries, malt and soft drink factories are some of the first established industrial businesses, along with book printing and publishing. At the bottom of the figure, it is evident that electrical appliance and mechanical machinery manufacturers, as well as firms in the chemical and pharmaceutical industries have the greatest number of firms founded in the years just prior to 1947, when our industrial firm catalogue is produced. 

```{r}
#| label: fig-density-ridges
#| fig-cap: "Density plot showing the foundation year of the firms in the 20 categories derived from the business descriptions"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/geom_density_ridges.png")
```

To cluster the firms geographically, I made use of the Density-Based Spatial Clustering of Applications with Noise (DBSCAN) algorithm. Unlike k-means, DBSCAN doesn't require you to specify the number of clusters in advance. It finds the number of clusters based on the distribution of the data (over geography in this case). The algorithm works by picking an aribtrary point, and retrieving all points in its ε-neighborhood, a distance threshold. If there are a minimum number of points within this neighborhood, a cluster is started, and the point is marked as a core point. Otherwise, it's marked as noise (temporarily). For each core point, all points within its ε-neighborhood become part of the cluster. This process continues until there are no more points to add to the cluster. The algorithm then picks another unvisited point and repeats the process, leading to the discovery of additional clusters or noise [@WierzchonKlopotek2018]. DBSCAN is particularly useful in this context because it can handle irregularly shaped clusters and is robust to outliers, making it suitable for real-world geographic data where firms are not be evenly distributed.

In my case, I used the coordinates of each firm as the primary variables by which clusters were examined, and then provided the firm type cluster as an additional variable. In @fig-map-common-types I show the geographic clusters that were uncovered with the DBSCAN algorithm, labelling each cluster with the most common firm type in that cluster. I should be clear that not every firm within the geographic cluster show as a dot is of the same firm type, rather, each cluster is shown with the most common firm type as a way to understand the geography of Swedish industrial firms in 1947.

What we learn from this map is that the most common firm type in rural areas and the North of Sweden are wood, sawmill and carpentry firms. This makes sense. Further, we see a cluster of metal goods mechanical workshops (in red) near to a cluster of steel and metal industries (light orange). Electricaal appliance firms cluster around Stockholm and Uppsala, as well as Karlstad (North of the large lake in the West of Sweden).

```{r}
#| label: fig-map-common-types
#| fig-cap: "Map of the geographic clusters of businesses by most common business type"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/map_most_common_businesses.png")
```

## Findings

With this rich individual level biographic data and information on the clusters of different firms, we can show detailed life courses for the individuals of interest. @fig-engineer-movements shows the paths of four individuals who worked in electricity related industries in my sample. They held HISCO code 34, titled "Electrical and Electronics Engineering Technicians" @vanLeeuwen2002HISCO. We can see that these individuals moved away from home to pursue education, and ended up further from their roots in search of new occupations related to the skills that they had acquired. 

```{r}
#| label: fig-engineer-movements
#| fig-cap: "Geographic trajectories of selected electrical technicians and engineers"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/eee_map.png")
```


This is bourne out in @fig-engineer-distances. This plots the average distance moved by engineers within different sectors^[engineers are all those with HISCO code beginning 2X]. Compared to the average distance that a working age adult lived away from their birthplace in the 1930 census of 24km, the average engineer working in the electrical appliance sector in our sample moved 350km from their place of birth, the furthest of all engineers. Even engineers working in the densely geographically concentrated steel and metal industries moved on average 167km away from home.

```{r}
#| label: fig-engineer-distances
#| fig-cap: "Distances moved by engineers by industrial sector"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/engineer_distance.png")
```

@fig-avg-distances shows that of all the common HISCO codes in the sample detailed in @fig-hisco-counts, engineers and mechanical engineers moved the furthest on average. We can also calculate, based on the geographic firm clusters, that of the engineers in the sample, 34 percent live closest to the geographic cluster where the most common firm type is electrical appliances and mechanical machinery.

```{r}
#| label: fig-avg-distances
#| fig-cap: "Distances moved by engineers by industrial sector"
#| fig-width: 5
#| out-width: 5in

knitr::include_graphics("assets/hisco_distance.png")
```

## Conclusion

To sum up, I have demonstrated how using of new tools and algortihms can give economic historians new kinds of source material to work with and new types of questions to ask. I showcased a two-part occupation and sector classification routine. I showed that contrary to my expectations, the individuals with high levels of skill who worked in electricity related industries in Sweden in the middle of the 20th century were not sourced from the localities around where production was centered. Rather, engineers working in electrical appliance and mechanical machinery industries moved the furthest from their places of birth, an average of 350km. This is indicative of a bifurcated labour market, with medium skilled jobs being filled by local workers, and specialized knowledge being brought in by workers with higher education from afar.

## Appendix {.appendix}

@fig-data-collection-process outlines the data collection process. 

I scrape the book content from the *Projekt Runeberg* website with an HTML scraper (beautiful soup in python).

I split the records using regular expressions in python, looking for specific terms that begin and end the records in the dictionaries and catalogue.

I augment the records with coordinates using the Google Maps Geocoding API. 

I store the data in JSON format, keeping the original text in the file alongside the derived key value pairs.
